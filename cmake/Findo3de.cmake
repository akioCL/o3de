#
# Copyright (c) Contributors to the Open 3D Engine Project.
# For complete copyright and license terms please see the LICENSE at the root of this distribution.
#
# SPDX-License-Identifier: Apache-2.0 OR MIT
#
#

# Generated by O3DE

include(FindPackageHandleStandardArgs)

# This will be called from within the installed engine's CMakeLists.txt
macro(ly_find_o3de_packages)
    add_subdirectory(Code/Framework/AtomCore)
    add_subdirectory(Code/Framework/AzCore)
    add_subdirectory(Code/Framework/AzQtComponents)
    add_subdirectory(Code/Framework/AzFramework)
    add_subdirectory(Code/Framework/AzGameFramework/AzGameFramework)
    add_subdirectory(Code/Framework/AzTest)
    add_subdirectory(Code/Framework/AzToolsFramework)
    add_subdirectory(Code/Framework/AzManipulatorTestFramework)
    add_subdirectory(Code/Framework/AzNetworking)
    add_subdirectory(Code/Framework/Crcfix)
    add_subdirectory(Code/Framework/GFxFramework/GFxFramework)
    add_subdirectory(Code/Framework/GridMate)
    add_subdirectory(Code/LauncherUnified)
    add_subdirectory(Code/Legacy/CryCommon)
    add_subdirectory(Code/Legacy/CrySystem/XML)
    add_subdirectory(Code/Legacy/CrySystem)
    add_subdirectory(Code/Editor/Plugins/EditorCommon)
    add_subdirectory(Code/Editor/Plugins/ComponentEntityEditorPlugin)
    add_subdirectory(Code/Editor/Plugins/FFMPEGPlugin)
    add_subdirectory(Code/Editor/Plugins/ProjectSettingsTool)
    add_subdirectory(Code/Editor/Plugins/PerforcePlugin)
    add_subdirectory(Code/Editor/Plugins/EditorAssetImporter)
    add_subdirectory(Code/Editor)
    add_subdirectory(Code/Tools/SceneAPI/SceneBuilder)
    add_subdirectory(Code/Tools/SceneAPI/SceneCore)
    add_subdirectory(Code/Tools/SceneAPI/SceneData)
    add_subdirectory(Code/Tools/SceneAPI/SceneUI)
    add_subdirectory(Code/Tools/SceneAPI/SDKWrapper)
    add_subdirectory(Code/Tools/AssetProcessor/AssetBuilderSDK)
    add_subdirectory(Code/Tools/AssetProcessor/AssetBuilder)
    add_subdirectory(Code/Tools/AssetProcessor)
    add_subdirectory(Code/Tools/AWSNativeSDKInit)
    add_subdirectory(Code/Tools/AzTestRunner)
    add_subdirectory(Code/Tools/CrashHandler/Support)
    add_subdirectory(Code/Tools/CrashHandler)
    add_subdirectory(Code/Tools/CrashHandler/Tools)
    add_subdirectory(Code/Tools/PythonBindingsExample)
    add_subdirectory(Code/Tools/RemoteConsole)
    add_subdirectory(Code/Tools/DeltaCataloger)
    add_subdirectory(Code/Tools/SerializeContextTools)
    add_subdirectory(Code/Tools/AssetBundler)
    add_subdirectory(Code/Tools/GridHub)
    add_subdirectory(Code/Tools/Standalone)
    add_subdirectory(Code/Tools/TestImpactFramework/Runtime/Code)
    add_subdirectory(Code/Tools/TestImpactFramework/Frontend/Console/Code)
    add_subdirectory(Code/Tools/ProjectManager)
    add_subdirectory(Gems/Achievements/Code)
    add_subdirectory(Gems/AssetMemoryAnalyzer/Code)
    add_subdirectory(Gems/AssetValidation/Code)
    add_subdirectory(Gems/Atom/Asset/ImageProcessingAtom/Code)
    add_subdirectory(Gems/Atom/Asset/Shader/Code)
    add_subdirectory(Gems/Atom/Bootstrap/Code)
    add_subdirectory(Gems/Atom/Component/DebugCamera/Code)
    add_subdirectory(Gems/Atom/Feature/Common/Code)
    add_subdirectory(Gems/Atom/RHI/Code)
    add_subdirectory(Gems/Atom/RHI/DX12/Code)
    add_subdirectory(Gems/Atom/RHI/Metal/Code)
    add_subdirectory(Gems/Atom/RHI/Vulkan/Code)
    add_subdirectory(Gems/Atom/RHI/Null/Code)
    add_subdirectory(Gems/Atom/RPI/Code)
    add_subdirectory(Gems/Atom/Tools/AtomToolsFramework/Code)
    add_subdirectory(Gems/Atom/Tools/MaterialEditor/Code)
    add_subdirectory(Gems/Atom/Tools/ShaderManagementConsole/Code)
    add_subdirectory(Gems/Atom/Utils/Code)
    add_subdirectory(Gems/AtomContent/ReferenceMaterials)
    add_subdirectory(Gems/AtomContent/Sponza)
    add_subdirectory(Gems/AtomContent)
    add_subdirectory(Gems/AtomLyIntegration/CommonFeatures/Code)
    add_subdirectory(Gems/AtomLyIntegration/ImguiAtom/Code)
    add_subdirectory(Gems/AtomLyIntegration/AtomImGuiTools/Code)
    add_subdirectory(Gems/AtomLyIntegration/EMotionFXAtom/Code)
    add_subdirectory(Gems/AtomLyIntegration/AtomFont/Code)
    add_subdirectory(Gems/AtomLyIntegration/TechnicalArt/DccScriptingInterface/Code)
    add_subdirectory(Gems/AtomLyIntegration/AtomBridge/Code)
    add_subdirectory(Gems/AtomLyIntegration/AtomViewportDisplayInfo/Code)
    add_subdirectory(Gems/AtomLyIntegration/AtomViewportDisplayIcons/Code)
    add_subdirectory(Gems/AudioEngineWwise/Code)
    add_subdirectory(Gems/AudioSystem/Code)
    add_subdirectory(Gems/AWSClientAuth/Code)
    add_subdirectory(Gems/AWSCore/Code)
    add_subdirectory(Gems/AWSGameLift/Code/AWSGameLiftClient)
    add_subdirectory(Gems/AWSGameLift/Code/AWSGameLiftServer)
    add_subdirectory(Gems/AWSMetrics/Code)
    add_subdirectory(Gems/BarrierInput/Code)
    add_subdirectory(Gems/Blast/Code)
    add_subdirectory(Gems/Camera/Code)
    add_subdirectory(Gems/CameraFramework/Code)
    add_subdirectory(Gems/CertificateManager/Code)
    add_subdirectory(Gems/CrashReporting/Code)
    add_subdirectory(Gems/CustomAssetExample/Code)
    add_subdirectory(Gems/DebugDraw/Code)
    add_subdirectory(Gems/DevTextures)
    add_subdirectory(Gems/EditorPythonBindings/Code)
    add_subdirectory(Gems/EMotionFX/Code)
    add_subdirectory(Gems/ExpressionEvaluation/Code)
    add_subdirectory(Gems/FastNoise/Code)
    add_subdirectory(Gems/GameState/Code)
    add_subdirectory(Gems/GameStateSamples/Code)
    add_subdirectory(Gems/Gestures/Code)
    add_subdirectory(Gems/GradientSignal/Code)
    add_subdirectory(Gems/GraphCanvas/Code)
    add_subdirectory(Gems/GraphModel/Code)
    add_subdirectory(Gems/HttpRequestor/Code)
    add_subdirectory(Gems/ImGui/Code)
    add_subdirectory(Gems/InAppPurchases/Code)
    add_subdirectory(Gems/LandscapeCanvas/Code)
    add_subdirectory(Gems/LmbrCentral/Code)
    add_subdirectory(Gems/LocalUser/Code)
    add_subdirectory(Gems/LyShine/Code)
    add_subdirectory(Gems/LyShineExamples/Code)
    add_subdirectory(Gems/Maestro/Code)
    add_subdirectory(Gems/MessagePopup/Code)
    add_subdirectory(Gems/Metastream/Code)
    add_subdirectory(Gems/Microphone/Code)
    add_subdirectory(Gems/Multiplayer/Code)
    add_subdirectory(Gems/MultiplayerCompression/Code)
    add_subdirectory(Gems/NvCloth/Code)
    add_subdirectory(Gems/PBSreferenceMaterials)
    add_subdirectory(Gems/PhysX/Code/NumericalMethods)
    add_subdirectory(Gems/PhysX/Code)
    add_subdirectory(Gems/PhysXDebug/Code)
    add_subdirectory(Gems/PhysXSamples)
    add_subdirectory(Gems/Prefab/PrefabBuilder)
    add_subdirectory(Gems/Presence/Code)
    add_subdirectory(Gems/PrimitiveAssets)
    add_subdirectory(Gems/PythonAssetBuilder/Code)
    add_subdirectory(Gems/QtForPython/Code)
    add_subdirectory(Gems/RADTelemetry/Code)
    add_subdirectory(Gems/SaveData/Code)
    add_subdirectory(Gems/SceneLoggingExample/Code)
    add_subdirectory(Gems/SceneProcessing/Code)
    add_subdirectory(Gems/ScriptCanvas/Code)
    add_subdirectory(Gems/ScriptCanvasDeveloper/Code)
    add_subdirectory(Gems/ScriptCanvasPhysics/Code)
    add_subdirectory(Gems/ScriptCanvasTesting/Code)
    add_subdirectory(Gems/ScriptedEntityTweener/Code)
    add_subdirectory(Gems/ScriptEvents/Code)
    add_subdirectory(Gems/SliceFavorites/Code)
    add_subdirectory(Gems/StartingPointCamera/Code)
    add_subdirectory(Gems/StartingPointInput/Code)
    add_subdirectory(Gems/StartingPointMovement/Code)
    add_subdirectory(Gems/SurfaceData/Code)
    add_subdirectory(Gems/TestAssetBuilder/Code)
    add_subdirectory(Gems/TextureAtlas/Code)
    add_subdirectory(Gems/TickBusOrderViewer/Code)
    add_subdirectory(Gems/Twitch/Code)
    add_subdirectory(Gems/UiBasics)
    add_subdirectory(Gems/Vegetation/Code)
    add_subdirectory(Gems/VideoPlaybackFramework/Code)
    add_subdirectory(Gems/VirtualGamepad/Code)
    add_subdirectory(Gems/WhiteBox/Code)

# Make sure the cmake configure dependency added here is a normalized path to engine.json,
# because later it's read again using a path like ${LY_ROOT_FOLDER}/engine.json, which
# is also normalized.  They should match to avoid errors on some build systems.
cmake_path(SET engine_json_path NORMALIZE ${current_path}/../engine.json)
file(READ ${engine_json_path} engine_json)
set_property(DIRECTORY APPEND PROPERTY CMAKE_CONFIGURE_DEPENDS ${engine_json_path})

string(JSON this_engine_name ERROR_VARIABLE json_error GET ${engine_json} engine_name)
if(json_error)
    message(FATAL_ERROR "Unable to read key 'engine_name' from '${engine_json_path}', error: ${json_error}")
endif()

# Make sure we are matching LY_ENGINE_NAME_TO_USE with the current engine
set(found_matching_engine FALSE)
if(this_engine_name STREQUAL LY_ENGINE_NAME_TO_USE)
    set(found_matching_engine TRUE)
endif()

find_package_handle_standard_args(o3de
    "Could not find an engine with matching ${LY_ENGINE_NAME_TO_USE}"
    found_matching_engine
)

# We are using the engine's CMakeLists.txt to handle initialization/importing targets
# Since this is external to the project's source, we need to specify an output directory
# even though we don't build
macro(o3de_initialize)
    set(INSTALLED_ENGINE TRUE)
    set(LY_PROJECTS ${CMAKE_SOURCE_DIR})
    o3de_current_file_path(current_path)
    add_subdirectory(${current_path}/.. o3de)
endmacro()
